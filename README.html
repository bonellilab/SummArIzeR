<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
box-sizing: border-box;
min-width: 200px;
max-width: 980px;
margin: 0 auto;
padding: 45px;
padding-top: 0px;
}
</style>


</head>

<body>

<h1 id="readme">README</h1>
<p>Anela Tosevska June 5, 2025</p>
<!-- README.md is generated from README.Rmd. Please edit that file -->

<h1 id="summarizer">SummArIzeR</h1>
<!-- badges: start -->

<!-- badges: end -->

<p><code>SummArIzeR</code> is an R package, that allows an easy use of
EnrichR to compare enrichment results from multiple databases of
multiple conditons. It results in a clustering of enriched terms and
enables the annotation of these terms by creating a promt for large
language models such as gpt4. Results can be vizualised in a
Heatmap.</p>
<p>If you are using <code>SummArIzeR</code> for your publication, please
cite us:</p>
<p>SummArIzeR: Simplifying cross-database enrichment result clustering
and annotation via large language models Marie Brinkmann, Michael
Bonelli, Anela Tosevska bioRxiv 2025.05.28.656331; doi: <a href="https://doi.org/10.1101/2025.05.28.656331">https://doi.org/10.1101/2025.05.28.656331</a></p>
<h2 id="features">Features</h2>
<ul>
<li>Perform enrichment analysis using <code>enrichR</code>.</li>
<li>Allows analysis of multiple conditions</li>
<li>Analyze up- and down-regulated genes separately.</li>
<li>Filter terms by p-value and gene thresholds.</li>
<li>Calculates similarities of results terms based on included
genes</li>
<li>Clusters terms using random walk algorithm</li>
<li>Generates a prompt for a LLM to summarized cluster annotations</li>
<li>Allows easy heatmap visualization</li>
</ul>
<h2 id="installation">Installation</h2>
<p>You can install the development version of SummArIzeR from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Install devtools if not already installed</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># Install SummArIzeR</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;bonellilab/SummArIzeR&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># Additional packages</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co"># Install factoextra from CRAN</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;factoextra&quot;</span>)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co"># Install `enrichR`</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;wjawaid/enrichR&quot;</span>)</span></code></pre></div>
<h2 id="example">Example</h2>
<p>This is a basic example which shows you how to run SummArIzeR. We
create an example dataframe from two celltypes comparing a disease and
control group:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(SummArIzeR)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(enrichR)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>genelist_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="at">genes =</span> <span class="fu">c</span>(</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    <span class="st">&quot;IL6&quot;</span>, <span class="st">&quot;IFNG&quot;</span>, <span class="st">&quot;IL10&quot;</span>, <span class="st">&quot;TNF&quot;</span>, <span class="st">&quot;CXCL8&quot;</span>, <span class="st">&quot;STAT3&quot;</span>, <span class="st">&quot;STAT1&quot;</span>, <span class="st">&quot;JAK1&quot;</span>, <span class="st">&quot;JAK2&quot;</span>, <span class="st">&quot;SOCS1&quot;</span>, </span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>    <span class="st">&quot;SOCS3&quot;</span>, <span class="st">&quot;IL1B&quot;</span>, <span class="st">&quot;IL18&quot;</span>, <span class="st">&quot;IL12A&quot;</span>, <span class="st">&quot;IL23A&quot;</span>, <span class="st">&quot;GATA3&quot;</span>, <span class="st">&quot;RORC&quot;</span>, <span class="st">&quot;CCR7&quot;</span>, <span class="st">&quot;CXCR3&quot;</span>, <span class="st">&quot;CCL2&quot;</span>,</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>    <span class="st">&quot;CCL5&quot;</span>, <span class="st">&quot;IRF4&quot;</span>, <span class="st">&quot;IRF5&quot;</span>, <span class="st">&quot;IL4R&quot;</span>, <span class="st">&quot;IL2&quot;</span>, <span class="st">&quot;FOXP3&quot;</span>, <span class="st">&quot;TGFB1&quot;</span>, <span class="st">&quot;IL7R&quot;</span>, <span class="st">&quot;IL15&quot;</span>, <span class="st">&quot;NFKB1&quot;</span>, </span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>    <span class="st">&quot;IL21&quot;</span>, <span class="st">&quot;CXCR5&quot;</span>, <span class="st">&quot;TYK2&quot;</span>, <span class="st">&quot;IL22&quot;</span>, <span class="st">&quot;IL17A&quot;</span>, <span class="st">&quot;IL17F&quot;</span>, <span class="st">&quot;MCP1&quot;</span>, <span class="st">&quot;IL1RN&quot;</span>, <span class="st">&quot;CXCL10&quot;</span>, <span class="st">&quot;CXCL11&quot;</span>, </span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>    <span class="st">&quot;CD40LG&quot;</span>, <span class="st">&quot;IL6R&quot;</span>, <span class="st">&quot;IL27&quot;</span>, <span class="st">&quot;CD28&quot;</span>, <span class="st">&quot;CD80&quot;</span>, <span class="st">&quot;CD86&quot;</span>, <span class="st">&quot;IL2RA&quot;</span>, <span class="st">&quot;CTLA4&quot;</span>, <span class="st">&quot;PDCD1&quot;</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>  ),</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>  <span class="at">Group =</span> <span class="fu">c</span>(</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>    <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Control&quot;</span>, </span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>    <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Disease&quot;</span>, </span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>    <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Disease&quot;</span>, </span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>    <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Disease&quot;</span>, </span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>    <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Control&quot;</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>  ),</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>  <span class="at">CellType =</span> <span class="fu">c</span>(</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>    <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;Monocytes&quot;</span>, <span class="st">&quot;Monocytes&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;Monocytes&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;Monocytes&quot;</span>, </span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>    <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;Monocytes&quot;</span>, <span class="st">&quot;Monocytes&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;Monocytes&quot;</span>, </span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>    <span class="st">&quot;Monocytes&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;Monocytes&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;Monocytes&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;Monocytes&quot;</span>, <span class="st">&quot;Monocytes&quot;</span>, </span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>    <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;Monocytes&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;Monocytes&quot;</span>, <span class="st">&quot;Monocytes&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;CD4&quot;</span>, </span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>    <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;Monocytes&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;Monocytes&quot;</span>, <span class="st">&quot;Monocytes&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;CD4&quot;</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>  ),</span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>  <span class="at">log2fold =</span> <span class="fu">c</span>(<span class="fl">1.65922417</span>, <span class="fl">1.74830165</span>, <span class="sc">-</span><span class="fl">0.85544186</span>, <span class="fl">1.32179050</span>, <span class="fl">0.56698208</span>, <span class="fl">0.07638380</span>, <span class="fl">0.94635326</span>, <span class="sc">-</span><span class="fl">1.46133361</span>, <span class="fl">0.62796916</span>, <span class="fl">0.82025914</span>, <span class="sc">-</span><span class="fl">0.16903290</span>, <span class="fl">0.87644901</span>, <span class="fl">1.73868899</span>, <span class="sc">-</span><span class="fl">0.97828470</span>, <span class="sc">-</span><span class="fl">0.15082871</span>, <span class="fl">1.76005809</span>, <span class="fl">1.91290571</span>, <span class="sc">-</span><span class="fl">1.53005055</span>, <span class="sc">-</span><span class="fl">0.10001167</span>, <span class="fl">0.24133098</span>, <span class="fl">1.61612555</span>, <span class="sc">-</span><span class="fl">1.44515933</span>, <span class="fl">1.95556692</span>, <span class="fl">1.78667293</span>, <span class="sc">-</span><span class="fl">1.67024977</span>, <span class="fl">0.05684714</span>, <span class="sc">-</span><span class="fl">0.43918613</span>, <span class="fl">1.62295252</span>, <span class="sc">-</span><span class="fl">0.21212149</span>, <span class="fl">1.34401704</span>, <span class="fl">0.95038247</span>, <span class="fl">1.24422057</span>, <span class="sc">-</span><span class="fl">0.44756687</span>, <span class="fl">0.74067892</span>, <span class="sc">-</span><span class="fl">1.98420664</span>, <span class="fl">1.33166432</span>, <span class="sc">-</span><span class="fl">1.97066341</span>, <span class="sc">-</span><span class="fl">1.16936411</span>, <span class="fl">1.62640563</span>, <span class="fl">0.44711457</span>, <span class="sc">-</span><span class="fl">0.48176304</span>, <span class="sc">-</span><span class="fl">0.25691366</span>, <span class="sc">-</span><span class="fl">1.85027587</span>, <span class="fl">1.89415966</span>, <span class="sc">-</span><span class="fl">0.27299500</span>, <span class="fl">1.83030639</span>, <span class="fl">1.55101962</span>, <span class="fl">0.55991508</span>, <span class="fl">1.88386644</span>)</span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>)</span></code></pre></div>
<p>We can perform the enrichment analysis for the different conditions
CellType and Group: Here we extract the top 5 hits from every database
and every condition. The input is data.frame with gene-level data. Must
include a “genes” column, conditions column, and, optionally, “log2fold”
if splitting by regulation. If split_by_reg (default = FALSE) is set to
TRUE, enrichment is performed separately on up- and down-regulated
genes. The logFC_threshold (default = 0) parameter defines the log
fold-change cutoff used to define up/down regulation when split_by_reg =
TRUE. The adjusted p-value cutoff is used to filter significant enriched
terms. The parameter n (default = 10) shwos the number of top enriched
terms to return per condition and per category, whereas the
min_genes_threshold (default = 3) is the minimum number of genes
required to consider a term in downstream analysis. The enrichment
categories can be chosen from the set of libraries available in <a href="https://maayanlab.cloud/Enrichr/#libraries">EnrichR</a>.</p>
<p>Edges below the similarity treshold (ts) are deleted. The optimal
treshold can be validated by checking the number of clusters, the
connected terms and the modularity. The threshold value determins which
edges between terms (nodes) are retained in the network (those with a
distance weight higher than ts). Smaller values include more edges;
larger values result in sparser graphs.</p>
<p>The network can be interactively visualized, and if needed, the
threshold can be readjusted.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>plot<span class="ot">&lt;-</span><span class="fu">TRUplotIgraph</span>(Termlist_all, <span class="at">ts  =</span> <span class="fl">0.3</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#htmltools::tagList(plot)</span></span></code></pre></div>
<p>After treshold adjustment, clusters can be assigned to the dataframe
and the Prompt can be generated:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>Genelist_test_cluster<span class="ot">&lt;-</span><span class="fu">returnIgraphCluster</span>(Termlist_all, <span class="at">ts =</span> <span class="fl">0.3</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">head</span>(Genelist_test_cluster, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">generateGPTPrompt</span>(Genelist_test_cluster)</span></code></pre></div>
<p>The prompt can be queried using a LLM like ChatGPT. The result can be
copied into R. Now, a final data frame containing the cluster
annotations can be created:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">#Enter vector from LLM </span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>cluster_summary <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="st">&#39;1&#39;</span> <span class="ot">=</span> <span class="st">&#39;T Cell Transcriptional Regulation&#39;</span>,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="st">&#39;2&#39;</span> <span class="ot">=</span> <span class="st">&#39;Interleukin Signaling Pathways&#39;</span>,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="st">&#39;3&#39;</span> <span class="ot">=</span> <span class="st">&#39;Inflammatory Response Activation&#39;</span>,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="st">&#39;4&#39;</span> <span class="ot">=</span> <span class="st">&#39;STAT and IL-17 Pathway Regulation&#39;</span>,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="st">&#39;5&#39;</span> <span class="ot">=</span> <span class="st">&#39;Cytokine-Mediated Immune Signaling&#39;</span>,</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  <span class="st">&#39;6&#39;</span> <span class="ot">=</span> <span class="st">&#39;T Cell Proliferation and Inflammatory Regulation&#39;</span>,</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="st">&#39;7&#39;</span> <span class="ot">=</span> <span class="st">&#39;IL-20 Family Signaling&#39;</span>,</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  <span class="st">&#39;8&#39;</span> <span class="ot">=</span> <span class="st">&#39;Cytokine Response&#39;</span>,</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  <span class="st">&#39;9&#39;</span> <span class="ot">=</span> <span class="st">&#39;Type II Interferon Response&#39;</span>,</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>  <span class="st">&#39;10&#39;</span> <span class="ot">=</span> <span class="st">&#39;Antiviral Cellular Response&#39;</span>,</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>  <span class="st">&#39;11&#39;</span> <span class="ot">=</span> <span class="st">&#39;Chemokine Signaling&#39;</span>,</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>  <span class="st">&#39;12&#39;</span> <span class="ot">=</span> <span class="st">&#39;Negative Regulation of Organismal Processes&#39;</span>,</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>  <span class="st">&#39;13&#39;</span> <span class="ot">=</span> <span class="st">&#39;Th17 Cell Differentiation&#39;</span>,</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>  <span class="st">&#39;14&#39;</span> <span class="ot">=</span> <span class="st">&#39;Th1/Th2 Cell Differentiation&#39;</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>)</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="fu">print</span>(cluster_summary)</span></code></pre></div>
<p>The clusters can now be annotated based on the vectors defined above.
Here, one could specify different methods for pooling p-values resulting
from multiple terms. In addition, this pooled p-value is capped at a
min_pval (default = 1e-10), making it better suitable for plotting.
However, users can select a lower min_pval threshold.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>Annotation_list<span class="ot">&lt;-</span> <span class="fu">annotateClusters</span>(Genelist_test_cluster, cluster_summary)</span></code></pre></div>
<p>The results can be plotted as a Bubbleplot. If the enrichment was
done for up-and downregulation seperatly, the plot will be split for
up-and downregulated genes.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">plotBubbleplot</span>(Annotation_list)</span></code></pre></div>
<p>Additionally, the results can be plotted as a Heatmap. If the
enrichment was done for up-and downregulation seperatly, the Heatmap can
be split for up-and downregulated genes. The heatmap can be further
customized by setting cluster_rows/columns to TRUE.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#plotHeatmap(Annotation_list, rot = 90, annotation_bar = F, column_names_centered = F)</span></span></code></pre></div>
<p>If you encounter any errors or issues, or if you have a suggestion
please file an issue <a href="https://github.com/bonellilab/SummArIzeR/issues">here</a>.</p>

</body>
</html>
